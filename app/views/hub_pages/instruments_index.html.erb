<% content_for :title, @page_title %>
<% content_for :head do %>
  <meta name="turbo-cache-control" content="no-preview">
<% end %>

<%= render "hub_pages/hub_hero",
    title: t('score.instruments'),
    description: t('hub.instruments_description', count: @instruments.size),
    breadcrumb_label: t('score.instruments') %>

<div data-controller="list-filter"
     data-list-filter-search-attribute-value="instrumentName"
     data-list-filter-singular-text-value="<%= t('hub.instrument_found') %>"
     data-list-filter-plural-text-value="<%= t('hub.instruments_found') %>"
     data-list-filter-no-match-text-value="<%= t('hub.no_instruments_matching') %>"
     data-list-filter-hidden-class="hidden"
     data-list-filter-filtered-class="filtered-out"
     data-list-filter-disabled-class="disabled"
     data-list-filter-active-class="active"
     data-list-filter-visible-class="visible">

  <div class="max-w-7xl mx-auto px-4 sm:px-6 pt-8 sm:pt-12">
    <%= render "hub_pages/hub_finder",
        placeholder: t('hub.search_instruments'),
        clear_label: t('hub.clear_search') %>

    <%= render "hub_pages/hub_alphabet_nav", include_hash: true %>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 py-0 sm:py-8">
    <% if @instruments.any? %>
      <% global_index = 0 %>
      <% hub_group_by_letter(@instruments).each do |letter, instruments_in_group| %>
        <section class="hub-letter-group"
                 id="letter-<%= letter %>"
                 data-letter="<%= letter %>"
                 data-list-filter-target="group">
          <div class="hub-letter-group__header">
            <span class="hub-letter-group__badge"><%= letter %></span>
            <span class="hub-letter-group__count"><%= instruments_in_group.size %></span>
          </div>
          <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 sm:gap-4">
            <% instruments_in_group.each do |instrument| %>
              <%= render "hub_pages/hub_card_icon",
                  item: instrument,
                  path: instrument_path(slug: instrument[:slug]),
                  icon: instrument_icon(instrument[:name]),
                  search_attribute: "instrumentName",
                  index: global_index %>
              <% global_index += 1 %>
            <% end %>
          </div>
        </section>
      <% end %>

      <%= render "hub_pages/hub_no_results",
          message: t('hub.no_instruments_found'),
          hint: t('hub.try_different_spelling') %>
    <% else %>
      <%= render "hub_pages/hub_empty_state",
          icon: "ðŸŽµ",
          message: t('hub.no_scores_found') %>
    <% end %>
  </div>
</div>
