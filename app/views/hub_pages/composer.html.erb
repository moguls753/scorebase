<% content_for :title, @page_title %>

<!-- Hero Section -->
<section class="hub-hero py-8 sm:py-12 lg:py-16 border-b-2 border-[var(--color-border)]">
  <div class="max-w-7xl mx-auto px-4 sm:px-6">
    <!-- Breadcrumb -->
    <nav class="flex items-center gap-2 text-xs font-medium text-[var(--color-text-muted)] mb-4">
      <%= link_to root_path, class: "hover:text-[var(--color-accent)] transition-colors" do %>ScoreBase<% end %>
      <span class="text-[var(--color-border-subtle)]">/</span>
      <%= link_to composers_path, class: "hover:text-[var(--color-accent)] transition-colors" do %><%= t('sort.composer') %><% end %>
      <span class="text-[var(--color-border-subtle)]">/</span>
      <span class="text-[var(--color-accent)] truncate max-w-[150px]"><%= @composer_name %></span>
    </nav>

    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4">
      <div>
        <!-- Composer Initial Badge -->
        <div class="w-16 h-16 sm:w-20 sm:h-20 mb-4 flex items-center justify-center bg-[var(--color-accent)] text-white font-[var(--font-family-display)] font-black text-3xl sm:text-4xl border-2 border-[var(--color-border)] shadow-brutal">
          <%= @composer_name.first.upcase %>
        </div>

        <h1 class="text-2xl sm:text-3xl lg:text-4xl font-[var(--font-family-display)] mb-2 leading-tight font-black uppercase tracking-tight hero-title">
          <%= @composer_name %>
        </h1>
        <p class="text-sm sm:text-base font-medium hero-subtitle">
          <span class="text-[var(--color-accent)] font-bold"><%= number_with_delimiter(@total_count) %></span>
          <%= t('hub.scores_count', count: @total_count).downcase.gsub(@total_count.to_s, '').strip %>
        </p>
      </div>

      <!-- Sort Control -->
      <%= form_with url: composer_path(slug: params[:slug]), method: :get, data: { turbo_frame: "scores" }, class: "inline-block" do |f| %>
        <div class="sort-control">
          <label for="sort" class="sort-label">
            <span class="sort-icon">â†•</span>
            <span class="hidden xs:inline"><%= t('search.sort_by') %></span>
          </label>
          <%= f.select :sort,
              [[t('sort.popular'), "popularity"], [t('sort.rated'), "rating"], [t('sort.newest'), "newest"], [t('sort.title'), "title"]],
              { selected: @sort },
              { class: "sort-select", id: "sort", onchange: "this.form.requestSubmit()" }
          %>
        </div>
      <% end %>
    </div>
  </div>
</section>

<!-- Scores Grid -->
<turbo-frame id="scores" data-turbo-action="advance">
<div class="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-10">
  <% if @scores.any? %>
    <div class="grid grid-cols-2 xs:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 sm:gap-4 [&>*]:max-w-[280px]">
      <% @scores.each do |score| %>
        <%= render 'score_card', score: score %>
      <% end %>
    </div>

    <%= render 'shared/pagination', scores: @scores, turbo_frame: 'scores' %>
  <% else %>
    <div class="mm-card p-8 sm:p-12 text-center">
      <div class="text-6xl mb-4 text-[var(--color-border-subtle)]">ðŸŽ¼</div>
      <p class="text-[var(--color-text-muted)] font-medium"><%= t('hub.no_scores_found') %></p>
    </div>
  <% end %>
</div>
</turbo-frame>

<style>
  .hub-hero { background: linear-gradient(135deg, #ffffff 0%, #fefcf9 50%, #ffffff 100%); }
  [data-theme="dark"] .hub-hero { background: linear-gradient(135deg, #2a2520 0%, #1f1b18 50%, #2d2823 100%); }
  .shadow-brutal { box-shadow: 4px 4px 0 var(--shadow-color); }
</style>
